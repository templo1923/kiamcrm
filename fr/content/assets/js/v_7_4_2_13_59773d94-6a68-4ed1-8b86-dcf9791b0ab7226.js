import{j as e,_ as xe,cT as ge,an as fe,cU as ve,a1 as $,a2 as _,cC as je,$ as be,V as Ce,P as we,a5 as Ne,I as y,r as ke}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab710.js";import{a as r}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab74.js";import{q as _e,C as ye}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab78.js";import{A as q,L as G}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab75.js";import{u as Le,b as Ee,ay as Se,o as Re}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab723.js";import{u as Me}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab719.js";import{u as Ae}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab729.js";import{u as $e}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7125.js";import{u as Ie}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7105.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab747.js";import{E as Pe}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7116.js";import{V as Fe}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7229.js";import{I as ze,E as Be}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7199.js";import{b as Ue}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7154.js";import{W as c}from"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab718.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab77.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab76.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab79.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab72.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab73.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab728.js";import"./v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7156.js";const Te=r.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_4_2_13_59773d94-6a68-4ed1-8b86-dcf9791b0ab7230.js")),[]));function De({setListagem:C,perfilBase:v}){return e.jsx(r.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(Te,{setListagem:C,perfilBase:v})})}function He({}){const C=Le(t=>t.crm),{userTabs:v}=Ee(),{perfil:I}=Se(),{setActiveMenu:W,activeMenu:u,viewContatos:p,setViewContatos:L}=$e(),{open:P}=Re(),{setAgrupamentos:F,agrupamentos:z}=Ae(),{chats:K,setChats:B,setActiveAgrupamento:Y}=Ie(),{language:a}=Me(),U=r.useRef(null),[d,h]=r.useState(0),[w,T]=r.useState("abas"),[N,J]=r.useState([]),m=t=>{J(t.map(s=>({...s,id:we(s.id)})))},[x,Q]=r.useState([]),[o,g]=r.useState(()=>u==="Envio Rápido"?K:p.type==="edit"?p.content.chats:[]);r.useEffect(()=>{u==="Envio Rápido"&&B(o)},[o]);const[k,D]=r.useState(""),[M,X]=r.useState(),[Z,ee]=r.useState(!1);r.useEffect(()=>{(async()=>{ee(await c.Profile("isBusiness"))})()});const[E,H]=r.useState(!1),[S,te]=r.useState(p.type==="edit"?p.content.name:""),[R,se]=r.useState(p.type==="edit"?p.content.color:ge()),A=r.useRef(null),O=r.useRef(null);r.useEffect(()=>{const t=s=>{A.current&&!A.current.contains(s.target)&&!O.current.contains(s.target)&&H(!1)};return E&&document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[E]),r.useEffect(()=>{(async()=>{let s;switch(d){case 0:const i=await c.Contact("List","onlyMyContacts");m(i.sort((n,l)=>n.name.localeCompare(l.name)));break;case 1:m(await c.Chat("List"));break;case 2:s=await c.Labels("getAllLabels"),j(s[0].id);break;case 3:m(await c.Chat("List","onlyGroups"));break;case 4:s=await c.Chat("List","onlyGroups"),j(s[0].id);break;case 6:if(w==="abas")s=v.map(n=>({id:n.tag,name:n.tag})),j(v[0].tag);else{const n=C.find(l=>l.id===w).list;s=n.map(l=>({id:l.id,name:l.name})),j(n[0].id)}break;case 7:s=[{id:"all",name:`${a.todos}`},{id:"aniversariantes-mes",name:`${a.aniversariantes}`},{id:"Masculino",name:`${a.sexo_masculino}`},{id:"Feminino",name:`${a.sexo_feminino}`}],j("all");break}X(s)})()},[d,v,w]),r.useEffect(()=>{var s;const t=[];for(let i of N)(i.id.toUpperCase().includes(k.toUpperCase())||(s=i.name)!=null&&s.toUpperCase().includes(k.toUpperCase()))&&t.push(i);Q(t)},[k,N]);const j=async t=>{switch(d){case 2:m(await c.Contact("List",{type:"withLabels",id:t,activeLid:!0}));break;case 4:m(await c.Chat("List",{type:"getContatosGrupos",id:t,activeLid:!0}));break;case 6:if(w==="abas"){const i=v.filter(n=>n.tag===t);m(i.length!==0?await c.Utils("get-crmContatos",i[0].chats):[])}else{const n=C.find(l=>l.id===w).list.filter(l=>l.id===t);m(n.length!==0?await c.Utils("get-crmContatos",n[0].chats):[])}break;case 7:const s=I.map(i=>({id:i.userID,...i}));switch(t){case"all":m(await c.Utils("get-crmContatos",s));break;case"aniversariantes-mes":const i=new Date().getMonth(),n=s.filter(f=>f.dataNascimento.length!==0&&i===new Date(f.dataNascimento).getMonth());m(await c.Utils("get-crmContatos",n));break;default:const l=s.filter(f=>f.sexo.length!==0&&f.sexo===t);m(await c.Utils("get-crmContatos",l));break}break}},ae=t=>{const s=o.findIndex(i=>i.id===t.id);if(s===-1)g([...o,t]);else{const i=[...o];i.splice(s,1),g(i)}},ne=()=>{const t=o.map(i=>i.id),s=x.filter(i=>!t.includes(i.id));g([...o,...s])},ie=()=>{const t=o.map(n=>n.id),s=x.filter(n=>t.includes(n.id)),i=o.filter(n=>!s.some(l=>l.id===n.id));g(i)},oe=()=>x.map(s=>s.id).every(s=>o.some(i=>i.id===s)),b=t=>{if(t>0){const s=o.slice();for(let i=0;i<t;i++){const n=x.find(l=>!s.some(f=>f.id===l.id));n&&s.push(n)}g(s)}else if(t<0){const s=Math.abs(t),i=o.slice(0,-s);g(i)}},V=()=>o.length===0?(y({type:"Error",message:`${a.selecione_um_cts}`,position:"top-right"}),!1):S.length<3?(y({type:"Error",message:`${a.insira_nome}`,position:"top-right"}),!1):!0,re=()=>{V()&&(F([...z,{id:ke(),name:S,color:R,chats:o}]),L({isOpen:!0,type:"create",content:[]}),y({type:"Success",message:`${a.agrupamento_criado}`,position:"top-right"}))},le=()=>{V()&&(F(z.map(t=>t.id===p.content.id?{id:p.content.id,name:S,color:R,chats:o}:t)),L({isOpen:!0,type:"create",content:[]}),y({type:"Success",message:`${a.agrupamento_editado}`,position:"top-right"}))},ce=()=>{if(o.length===0){y({type:"Error",message:`${a.selecione_um_cts}`,position:"top-right"});return}B(o),Y({name:`${a.nao_agrupado}`,color:"var(--primaria)"}),W("Enviar Campanha")},de=e.jsxs("div",{className:"flex flex-col gap-4 justify-start w-[200px]",children:[a.cts_segmento,e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(d===0?"btn-activeList":""),onClick:()=>h(0),children:a.cts_salvos}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(d===1?"btn-activeList":""),onClick:()=>h(1),children:"Inbox"}),Z&&e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(d===2?"btn-activeList":""),onClick:()=>h(2),children:a.etiquetas}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(d===3?"btn-activeList":""),onClick:()=>h(3),children:a.grupos}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(d===4?"btn-activeList":""),onClick:()=>h(4),children:a.cts_grupos}),e.jsxs("div",{className:"dropdown dropdown-right dropdown-end",onClick:()=>h(6),children:[e.jsx("div",{tabIndex:0,role:"button",className:"btn-confirmation btn-agrupamento !w-full !flex justify-center items-center "+(d===6?"btn-activeList":""),children:"CRM"}),e.jsx("ul",{tabIndex:0,ref:U,className:"dropdown-content z-[1] menu p-2 shadow-lg bg-base-100 rounded-box w-52 _2sDI2 _1b6oD max-h-[1000%]",onClick:()=>U.current.blur(),children:e.jsxs("div",{className:"overflow-y-auto",children:[e.jsx("li",{children:e.jsxs("div",{className:"flex bugiwsl0 fooq7fky",onClick:()=>T("abas"),children:[e.jsx("span",{children:e.jsx(fe,{className:"h-5 w-5 text-[var(--primaria)]"})}),e.jsx("span",{children:a.abas})]})}),C.map(t=>e.jsx("li",{children:e.jsxs("div",{className:"flex bugiwsl0 fooq7fky",onClick:()=>T(t.id),children:[e.jsx("span",{style:{color:t.hexColor},children:e.jsx(_e,{className:"h-5 w-5"})}),e.jsx("span",{children:t.name})]})}))]})})]}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(d===7?"btn-activeList":""),onClick:()=>h(7),children:a.perfil_cts}),e.jsx("button",{className:"btn-confirmation btn-agrupamento w-full "+(d===5&&"btn-activeList"),onClick:()=>{h(5),P(e.jsx(ze,{list:t=>m(t)}))},children:a.importar_planilha}),e.jsx("span",{className:"flex items-center m-auto",children:e.jsx("button",{className:"btn-confirmation btn-8 m-auto",style:o.length===0?{backgroundImage:"none"}:{},onClick:()=>Be(o),children:e.jsxs("span",{className:"gap-2",children:[e.jsxs("div",{children:[" ",e.jsx(ve,{size:20})," "]}),e.jsxs("div",{className:"pt-1",children:[" ",a.exportaEmCSV," "]})]})})})]}),me=({index:t,key:s,style:i})=>{const n=x[t];return e.jsx("li",{style:i,children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label gap-2 justify-start",children:[e.jsx(Ne,{id:s,estado:o.some(l=>l.id===n.id),checkedUpdade:()=>ae(n)}),e.jsx("span",{className:"font-bold text-base overflow-hidden text-ellipsis whitespace-nowrap max-w-[300px]",children:n.name}),e.jsx("span",{children:n.id.includes("@")?n.id.split("@")[0]:n.id})]})})},s)},pe=e.jsxs("div",{className:"flex-auto grid",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 items-center pb-2",children:[e.jsx("span",{className:"w-full",children:e.jsx("input",{type:"text",value:k,onChange:t=>D(t.target.value),placeholder:a.pesquisar_numero,className:"input input-bordered w-full input-sm"})}),k.length!==0&&e.jsx("span",{className:"flex items-center",children:e.jsx($,{name:a.limpar,funcao:()=>D("")})}),x.length!==0&&e.jsx("span",{className:"flex items-center",style:{whiteSpace:"nowrap"},children:oe()?e.jsx($,{name:a.remover_todos,funcao:ie}):e.jsx(_,{name:`${a.selecionar_todos} (${N==null?void 0:N.length})`,funcao:ne})})]}),M&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{className:"select select-bordered w-full select-sm pt-0",onChange:t=>j(t.target.value),children:M.map((t,s)=>e.jsx("option",{value:t.id,children:t.name},s))}),d===7&&e.jsxs("div",{className:"btn-confirmation btn-agrupamento !flex justify-center items-center !px-2 gap-1",onClick:()=>P(e.jsx(De,{setListagem:m,perfilBase:I})),children:[e.jsx("span",{"data-icon":"filter",children:e.jsx("svg",{className:"fill-[var(--letra)]",viewBox:"0 0 24 24",height:"20",width:"20",preserveAspectRatio:"xMidYMid meet",version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 24 24",children:e.jsx("path",{d:"M10,18.1h4v-2h-4V18.1z M3,6.1v2h18v-2H3z M6,13.1h12v-2H6V13.1z"})})}),e.jsx("h3",{className:"text-[var(--letra)] whitespace-nowrap",children:a.filtro_avancado})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("div",{className:"badge bg-[var(--primaria)] pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>b(200),children:"+200"}),e.jsx("div",{className:"badge badge-error pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>b(-200),children:"-200"}),e.jsx("div",{className:"badge bg-[var(--primaria)] pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>b(100),children:"+100"}),e.jsx("div",{className:"badge badge-error pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>b(-100),children:"-100"}),e.jsx("div",{className:"badge bg-[var(--primaria)] pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>b(10),children:"+10"}),e.jsx("div",{className:"badge badge-error pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>b(-10),children:"-10"})]})]}),e.jsx("div",{className:"overflow-auto",children:e.jsx("ul",{className:"w-full overflow-auto overflow-x-hidden",style:M?{height:"calc(100vh - 250px)",maxHeight:"calc(100vh - 250px)"}:{height:"calc(100vh - 225px)",maxHeight:"calc(100vh - 225px)"},children:x.length!==0?e.jsx(q,{children:({width:t,height:s})=>e.jsx(G,{width:t,height:s,rowCount:x.length,rowHeight:35,rowRenderer:me})}):e.jsx("div",{className:"p-4 border-dotted border rounded-lg text-center mt-2",children:a.nenhum_cts_encontrado})})})]}),ue=({index:t,key:s,style:i})=>{const n=o[t];return e.jsx("li",{style:i,className:"!w-fit",children:e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(Fe,{id:n.id}),e.jsx("span",{className:"font-bold text-base overflow-hidden text-ellipsis whitespace-nowrap max-w-[200px]",children:n.name}),e.jsx("span",{children:n.id.includes("@")?n.id.split("@")[0]:n.id})]})},n.id)},he=e.jsxs("div",{className:"flex items-center flex-auto flex-col gap-4",children:[e.jsxs("div",{className:"indicator",children:[o.length!==0&&e.jsxs("span",{className:"indicator-item badge bg-[var(--primaria)] text-[var(--letra)] font-medium",children:["+",o.length]}),e.jsx("span",{className:"p-2 text-xl",children:a.cts_selecionados_envio})]}),o.length!==0&&e.jsx("div",{className:"absolute right-8 mt-6 top-[83px]",children:e.jsx($,{name:a.remover_selecao,funcao:()=>g([])})}),e.jsx("div",{className:"w-full pt-2",style:{height:`calc(100vh - ${u==="Envio Rápido"?"200px":"400px"} )`},children:e.jsx("ul",{className:"gap-2 justify-center ",style:{maxHeight:`calc(100vh - ${u==="Envio Rápido"?"200px":"400px"})`,height:`calc(100vh - ${u==="Envio Rápido"?"200px":"400px"})`},children:o.length!==0?e.jsx(q,{children:({width:t,height:s})=>e.jsx(G,{width:t,height:s,rowCount:o.length,rowHeight:25,rowRenderer:ue})}):e.jsx("div",{className:"p-4 rounded-lg text-center mt-2 overflow-hidden justify-center flex items-center",children:e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6 text-[var(--letra)]",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-[var(--letra)] font-medium",children:a.nenhum_cts_selecionado})]})})})}),u!=="Envio Rápido"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full grid gap-3",children:[E&&e.jsx("div",{className:"absolute",children:e.jsx("div",{className:"relative bottom-52",ref:A,children:e.jsx(ye,{disableAlpha:!0,color:R,onChange:t=>se(t.hex),className:"p-2 rounded"})})}),e.jsx(Pe,{id:"Agrupamento_TextArea",titulo:a.nome_agrupamento,type:"input",position:"top-end",placeholder:a.insira_nome_agrupamento,text:S,setText:t=>te(t),heightTextArea:490}),e.jsxs("div",{className:"flex  gap-2 items-center pt-3",children:[e.jsx("h2",{children:a.selecione_cor}),e.jsx("span",{className:"pulse cursor-pointer border border-black rounded border-solid lg:tooltip lg:tooltip-right",ref:O,onClick:()=>H(!E),"data-tip":a.selecionar_cor_agrupamento,children:e.jsx(je,{className:"h-8 w-8",style:{color:R}})})]})]}),e.jsx("div",{className:"pt-4 gap-4 pb-2 flex",children:p.type==="edit"?e.jsx(_,{name:a.editar,funcao:le}):e.jsxs(e.Fragment,{children:[e.jsx(_,{name:a.criar_agrupamento,funcao:re}),e.jsx(_,{name:a.enviar_sem_agrupar,funcao:ce})]})})]})]});return e.jsxs("div",{"data-id":a.envio_container,style:{height:"calc(100vh - 42px)"},children:[u!=="Envio Rápido"&&e.jsx(be,{children:a.desc_agrupamentos}),e.jsxs("div",{className:"flex gap-2 items-center p-2 pt-2",children:[e.jsx(Ce,{children:u==="Envio Rápido"?`${a.selecione_cts}`:p.type==="edit"?`${a.editar_agrupamento}`:`${a.criar_agrupamento}`}),u!=="Envio Rápido"&&(p.type==="edit"?e.jsx("span",{className:"pulse cursor-pointer lg:tooltip lg:tooltip-right","data-tip":a.voltar,onClick:()=>L({isOpen:!0,type:"create",content:[]}),children:e.jsx(Ue,{className:"w-6 h-6 text-[var(--primaria)]",strokeWidth:1})}):e.jsx("div",{className:"pulse cursor-pointer lg:tooltip lg:tooltip-right","data-tip":a.grupos_salvos_desc,children:e.jsx(_,{name:a.agrupamentos_salvos_contatos,funcao:()=>L({isOpen:!0,type:"create",content:[]})})}))]}),e.jsxs("div",{className:"flex pt-4 gap-5",style:{height:"calc(100vh - 121px)"},children:[de,pe,he]})]})}const ut=r.memo(He);export{ut as default};
